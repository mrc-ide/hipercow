<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Troubleshooting • hipercow</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Troubleshooting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hipercow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/hipercow.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>General</h6></li>
    <li><a class="dropdown-item" href="../articles/packages.html">Packages and provisioning</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Tasks</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Details</h6></li>
    <li><a class="dropdown-item" href="../articles/details.html">Details</a></li>
    <li><a class="dropdown-item" href="../articles/environments.html">Environments</a></li>
    <li><a class="dropdown-item" href="../articles/stan.html">Using stan</a></li>
    <li><a class="dropdown-item" href="../articles/INLA.html">Using INLA on Windows</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Clusters</h6></li>
    <li><a class="dropdown-item" href="../articles/dide-cluster.html">The DIDE Cluster</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced topics</h6></li>
    <li><a class="dropdown-item" href="../articles/workers.html">Workers</a></li>
    <li><a class="dropdown-item" href="../articles/administration.html">Administration</a></li>
    <li><a class="dropdown-item" href="../articles/migration.html">Migration from didehpc</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/hipercow/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Troubleshooting</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/hipercow/blob/main/vignettes/troubleshooting.Rmd" class="external-link"><code>vignettes/troubleshooting.Rmd</code></a></small>
      <div class="d-none name"><code>troubleshooting.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mrc-ide/hipercow" class="external-link">hipercow</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="my-task-failed">My task failed<a class="anchor" aria-label="anchor" href="#my-task-failed"></a>
</h2>
<p>Oh no!</p>
<div class="section level3">
<h3 id="caused-by-an-error-in-your-code">Caused by an error in your code<a class="anchor" aria-label="anchor" href="#caused-by-an-error-in-your-code"></a>
</h3>
<p>If your task status is <code>failure</code> that <em>probably</em>
indicates an error in your code. There are lots of reasons that this
could be for, and the first challenge is working out what happened.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/task_create_expr.html">task_create_expr</a></span><span class="op">(</span><span class="fu">mysimulation</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Submitted task '3f3e1988520a51e194e64986318402bc' using 'example'</span></span></code></pre></div>
<p>This task will fail, and <code><a href="../reference/task_status.html">task_status()</a></code> will report
<code>failure</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/task_status.html">task_status</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "failure"</span></span></code></pre></div>
<p>The first place to look is the result of the task itself. Unlike an
error in your console, an error that happens on the cluster can be
returned and inspected:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/task_result.html">task_result</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;simpleError in mysimulation(10): could not find function "mysimulation"&gt;</span></span></code></pre></div>
<p>In this case the error is because the function
<code>mysimulation</code> does not exist! This is because we’ve
forgotten to tell the cluster where to find it.</p>
<p>The other place worth looking is the task log (via
<code><a href="../reference/task_log.html">task_log_show()</a></code>), which provides more diagnostic
information. We will often ask you to show this to us.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/task_log.html">task_log_show</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">hipercow 1.1.5 running at '/home/runner/work/_temp/hv-20250513-33ca20eec34f'</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> library paths:</span></span>
<span><span class="co">#&gt; • /home/runner/work/_temp/Library</span></span>
<span><span class="co">#&gt; • /opt/R/4.5.0/lib/R/site-library</span></span>
<span><span class="co">#&gt; • /opt/R/4.5.0/lib/R/library</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> id: 3f3e1988520a51e194e64986318402bc</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> starting at: 2025-05-13 06:45:40.676054</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Task type: expression</span></span>
<span><span class="co">#&gt; • Expression: mysimulation(10)</span></span>
<span><span class="co">#&gt; • Locals: (none)</span></span>
<span><span class="co">#&gt; • Environment: default</span></span>
<span><span class="co">#&gt;   R_GC_MEM_GROW: 3</span></span>
<span><span class="co">#&gt; ───────────────────────────────────────────────────────────────── task logs ↓ ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ───────────────────────────────────────────────────────────────── task logs ↑ ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> status: failure</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Error: could not find function "mysimulation"</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> finishing at: 2025-05-13 06:45:40.676054 (elapsed: 0.2832 secs)</span></span></code></pre></div>
<p>In this case the task log does not have anything very interesting in
it.</p>
<p>Here’s another example, something that might work perfectly well on
your machine, but fails on the cluster:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/task_create_expr.html">task_create_expr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"c:/myfile.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Submitted task 'fc41c66200777b7f6cd48db6bdcdeb5c' using 'example'</span></span></code></pre></div>
<p>Here is the error, which is a bit less informative this time:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/task_result.html">task_result</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;simpleError in file(file, "rt"): cannot open the connection&gt;</span></span></code></pre></div>
<p>The log gives a better idea of what is going on - the file
<code>c:/myfile.csv</code> does not exist (because it is not found on
the cluster; using relative paths is much preferred to absolute
paths)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/task_log.html">task_log_show</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">hipercow 1.1.5 running at '/home/runner/work/_temp/hv-20250513-33ca20eec34f'</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> library paths:</span></span>
<span><span class="co">#&gt; • /home/runner/work/_temp/Library</span></span>
<span><span class="co">#&gt; • /opt/R/4.5.0/lib/R/site-library</span></span>
<span><span class="co">#&gt; • /opt/R/4.5.0/lib/R/library</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> id: fc41c66200777b7f6cd48db6bdcdeb5c</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> starting at: 2025-05-13 06:45:41.984056</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Task type: expression</span></span>
<span><span class="co">#&gt; • Expression: read.csv("c:/myfile.csv")</span></span>
<span><span class="co">#&gt; • Locals: (none)</span></span>
<span><span class="co">#&gt; • Environment: default</span></span>
<span><span class="co">#&gt;   R_GC_MEM_GROW: 3</span></span>
<span><span class="co">#&gt; ───────────────────────────────────────────────────────────────── task logs ↓ ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ───────────────────────────────────────────────────────────────── task logs ↑ ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> status: failure</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Error: cannot open the connection</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> 1 warning found:</span></span>
<span><span class="co">#&gt; • cannot open file 'c:/myfile.csv': No such file or directory</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> finishing at: 2025-05-13 06:45:41.984056 (elapsed: 0.2978 secs)</span></span></code></pre></div>
<p>The real content of the error message is present in the warning! You
can also get the warnings with</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/task_result.html">task_result</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">$</span><span class="va">warnings</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; &lt;simpleWarning in file(file, "rt"): cannot open file 'c:/myfile.csv': No such file or directory&gt;</span></span></code></pre></div>
<p>Which will be a list of all warnings generated during the execution
of your task (even if it succeeds). The traceback also shows what
happened:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/task_result.html">task_result</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">$</span><span class="va">trace</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">     </span>▆</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  1. </span>├─<span style="font-weight: bold;">rlang</span>::try_fetch(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  2. </span>│ ├─<span style="font-weight: bold;">base</span>::tryCatch(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  3. </span>│ │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  4. </span>│ │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  5. </span>│ │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  6. </span>│ └─base::withCallingHandlers(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  7. </span>├─<span style="font-weight: bold;">hipercow</span>:::task_eval_expression(data, envir, verbose)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  8. </span>│ ├─hipercow:::eval_with_hr(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  9. </span>│ │ └─<span style="font-weight: bold;">base</span>::force(expr)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 10. </span>│ └─base::eval(data$expr, envir)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 11. </span>│   └─base::eval(data$expr, envir)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 12. </span>├─<span style="font-weight: bold;">utils</span>::read.csv("c:/myfile.csv")</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 13. </span>│ └─utils::read.table(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 14. </span>│   └─<span style="font-weight: bold;">base</span>::file(file, "rt")</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 15. </span>└─base::.handleSimpleError(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 16. </span>  └─<span style="font-weight: bold;">rlang</span> (local) h(simpleError(msg, call))</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 17. </span>    └─handlers[[2L]](cnd)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="caused-by-an-error-during-startup">Caused by an error during startup<a class="anchor" aria-label="anchor" href="#caused-by-an-error-during-startup"></a>
</h3>
<p>These are harder to troubleshoot but we can still pull some
information out. The example here was a real-world case and illustrates
one of the issues with using a shared filesystem in the way that we do
here.</p>
<p>Suppose you have some code in <code>mycode.R</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">2</span> <span class="op">*</span> <span class="va">x</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can create an environment with this code and use it just fine:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hipercow_environment.html">hipercow_environment_create</a></span><span class="op">(</span>sources <span class="op">=</span> <span class="st">"mycode.R"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Created environment 'default'</span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/task_create_expr.html">task_create_expr</a></span><span class="op">(</span><span class="fu">times2</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Submitted task '7e2058cd8aa747d2c595a73bd2815f4a' using 'example'</span></span>
<span><span class="fu"><a href="../reference/task_wait.html">task_wait</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/task_result.html">task_result</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 20</span></span></code></pre></div>
<p>…but imagine then you’re editing the file and save the file but it is
not syntactically correct:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>times2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">*</span> x</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>}</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>newfun <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span></code></pre></div>
<p>And then you either submit a task, <strong>or</strong> a task that
you have previously submitted gets run (which could happen ages after
you submit it if the cluster is busy).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/task_create_expr.html">task_create_expr</a></span><span class="op">(</span><span class="fu">times2</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Submitted task '5b67476501b8655f11e87c980aa665a3' using 'example'</span></span>
<span><span class="fu"><a href="../reference/task_wait.html">task_wait</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/task_status.html">task_status</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "failure"</span></span></code></pre></div>
<p>The error here has happened before getting to your code - it is
happening when the source files are loaded. The log makes this a bit
clearer:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/task_log.html">task_log_show</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">hipercow 1.1.5 running at '/home/runner/work/_temp/hv-20250513-33ca20eec34f'</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> library paths:</span></span>
<span><span class="co">#&gt; • /home/runner/work/_temp/Library</span></span>
<span><span class="co">#&gt; • /opt/R/4.5.0/lib/R/site-library</span></span>
<span><span class="co">#&gt; • /opt/R/4.5.0/lib/R/library</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> id: 5b67476501b8655f11e87c980aa665a3</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> starting at: 2025-05-13 06:45:44.741024</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Task type: expression</span></span>
<span><span class="co">#&gt; • Expression: times2(10)</span></span>
<span><span class="co">#&gt; • Locals: (none)</span></span>
<span><span class="co">#&gt; • Environment: default</span></span>
<span><span class="co">#&gt;   R_GC_MEM_GROW: 3</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Loading environment 'default'...</span></span>
<span><span class="co">#&gt; • packages: <span style="font-style: italic;">(none)</span></span></span>
<span><span class="co">#&gt; • sources: <span style="font-weight: bold;">mycode.R</span></span></span>
<span><span class="co">#&gt; • globals: <span style="font-style: italic;">(none)</span></span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> status: failure</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Error: 5:0: unexpected end of input 3: } 4: newfun &lt;- function(x)   ^</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> finishing at: 2025-05-13 06:45:44.741024 (elapsed: 0.3015 secs)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="my-task-got-stuck-at-submitted">My task got stuck at <code>submitted</code><a class="anchor" aria-label="anchor" href="#my-task-got-stuck-at-submitted"></a>
</h3>
<!-- TODO: this is still too Windows specific -->
<p>(Previous users of <code>didehpc</code> may recognise this as being
stuck at <code>PENDING</code>).</p>
<p>This is the most annoying one, and can happen for many reasons. You
can see via the <a href="mrcdata.dide.ic.ac.uk/hpc/">web interface</a>
or the Microsoft cluster tools that your task has failed but
<code>hipercow</code> is reporting it as pending. This happens when
something has failed during the script that runs <em>before</em> any
<code>hipercow</code> code runs on the cluster.</p>
<p>Things that have triggered this situation in the past:</p>
<ul>
<li>An error in the Microsoft cluster tools</li>
<li>A misconfigured node (sometimes they are missing particular
software)</li>
<li>A networking issue</li>
<li>Gremlins</li>
<li>Network path mapping error</li>
<li>Running out of disk space after submitting your job</li>
</ul>
<p>There are doubtless others.</p>
<p>If you suspect your task has become stuck at <code>submitted</code>
(but is not actually running any more) you should try one or more
of:</p>
<ul>
<li>run <code><a href="../reference/task_info.html">task_info()</a></code> with your id which will fetch this true
id and tell you about any discrepancy</li>
<li>checking the web portal to see if the task is really listed as
queued. Check the failed tasks and see if it’s there</li>
<li>look at the <em>outer</em> logs
(<code>task_log_show(id, outer = TRUE)</code>) which will show you the
scheduler’s logs for this task, which may be informative.</li>
</ul>
</div>
<div class="section level3">
<h3 id="my-code-works-on-my-computer-but-not-on-the-cluster">My code works on my computer but not on the cluster<a class="anchor" aria-label="anchor" href="#my-code-works-on-my-computer-but-not-on-the-cluster"></a>
</h3>
<p>In that case, something is different between how the cluster sees the
world, and how your computer sees it.</p>
<ul>
<li>Look in the logs to try and find the reason why the failing tasks
are doing so.</li>
<li>Are there variables in the global R environment on your local
computer, that your code relies upon, that won’t be present on the
cluster? Do you have local R packages or sources loaded which you
haven’t told <code>hipercow</code> about?</li>
<li>Or any system variables, or other dependencies which enable your
task to work locally, but won’t be set up on a cluster node?</li>
<li>Are you referring to any files visible to your local machine, but
not on the cluster? Are you referring to <code>C:</code> for
instance?</li>
<li>(Rarely:) Are you viewing a cached version of any network storage on
your local computer, that has not been synced to the real network
storage view that the cluster has?</li>
<li>Check that you have not run out of disk-space. The Q: quota is
normally 15Gb.</li>
<li>If you are running C code, check for other causes of indeterminate
failures, such as uninitialised variables, or array out-of-bounds
errors. These are unpredictable errors by nature, but surprisingly often
you might get away with it on a local computer, while a cluster node
behaves differently.</li>
<li>If you are running stochastic code, check that you are
<em>really</em> using the same random number seeds. If you are expecting
exactly the same result from the cluster job, check that your code
produces the same answer if you repeat it locally.</li>
</ul>
</div>
<div class="section level3">
<h3 id="some-of-my-tasks-work-on-the-cluster-but-others-fail">Some of my tasks work on the cluster, but others fail<a class="anchor" aria-label="anchor" href="#some-of-my-tasks-work-on-the-cluster-but-others-fail"></a>
</h3>
<ul>
<li>Look in the logs to try and find the reason why the failing tasks do
so.</li>
<li>Try rerunning the failed tasks. Is it the same set that passes, and
the same set that fails? In that case, consider what makes your tasks
different - perhaps task-specific input data or parameters could cause
the failures.</li>
<li>If you find messages about <code>Error allocating a vector...</code>
or <code>std::bad_alloc</code>, then try and work out the memory usage
of a single task. Perhaps run it locally with task manager (Windows), or
<code>top</code>/<code>htop</code> (macOS/Linux) running, and watch to
see what the memory usage is. If the task is single-core, consider the
total memory used if you run 8 or 16 instances on the same cluster
machine. If the total memory exceeds the available, then behaviour will
be undefined, and some tasks will likely fail.</li>
<li>In the above example, note that someone else’s memory-hungry
combination of tasks may affect your small-memory task, if they run on
the same node. We don’t enforce any memory limits on tasks, which on the
whole, is nice and convenient, but it carries the risk that the above
can happen.</li>
<li>Always check you’re not running out disk space. The Q: quota is
normally 15Gb.</li>
<li>Find what node your tasks were running on. If you consistently get
errors on one node, but not others, then get in touch with Wes, as we do
get node failures from time to time, where the fault is not obvious at
first.</li>
</ul>
</div>
<div class="section level3">
<h3 id="my-code-is-slower-on-the-cluster-than-running-locally">My code is slower on the cluster than running locally!<a class="anchor" aria-label="anchor" href="#my-code-is-slower-on-the-cluster-than-running-locally"></a>
</h3>
<ul>
<li>This is expected, especially for single-core tasks. Cluster nodes
are often aiming to provide larger throughput, rather than better linear
performance, so a single task may run slower on a cluster node than on
your own computer. But the cluster node might be able to run 16 or more
such tasks at once, without taking any longer, while you continue using
your local computer for local things.</li>
<li>If that is still insufficient, and you still want to compare timings
in this way, then check that the cluster is doing <em>exactly</em> the
same work as your local computer.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="i-cant-connect-to-the-cluster">I can’t connect to the cluster<a class="anchor" aria-label="anchor" href="#i-cant-connect-to-the-cluster"></a>
</h2>
<p>There are lots of possible causes of this, and ways that this might
manifest as an error message, for example:</p>
<pre><code>Error in client_parse_submit(httr_text(r), 1L) :
  Job submission has likely failed; could be a login error</code></pre>
<p>(we will add other error messages here as we catch them).</p>
<p>By the time you get here, we’ve thrown a pretty generic error because
for some reason we can’t tell what has happened. Possible reasons that
you might see an error like this:</p>
<ul>
<li>Your local internet connection has failed</li>
<li>Your ZScaler session has timed out and needs re-authentication</li>
<li>Your cluster session has timed out</li>
<li>Your DIDE password has expired</li>
</ul>
<p>You can check most of these by running</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dide_check.html">dide_check</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>which will work through many common points of failure and report back
what does and does not work. If you want help with diagnosing this sort
of error, we would expect to see output from this command.</p>
<p>If that does work, but you are still having what looks like
connection problems, then try</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hipercow_hello.html">hipercow_hello</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>which will launch a simple job. If this does not work, and you want
to ask for help, we would like to see the whole output of this
command.</p>
<p>If that works, but your actual job does not work, then something
about what you are submitting is causing the problem. In this case, if
you are asking for help, we would need to know something about your
code, in which case read on for the next section.</p>
</div>
<div class="section level2">
<h2 id="asking-for-help">Asking for help<a class="anchor" aria-label="anchor" href="#asking-for-help"></a>
</h2>
<p>If you need help, you can ask in the “Cluster” teams channel. This is
better than emailing Rich or Wes directly as they may not have time to
respond, or may be on leave.</p>
<p>When asking for help it is really important that you make it as easy
as possible for us to help you. This is surprisingly hard to do well,
and we would ask that you first take a look at these two short
articles:</p>
<ul>
<li><a href="https://stackoverflow.com/help/how-to-ask" class="external-link">How to ask a
good question</a></li>
<li><a href="https://stackoverflow.com/help/minimal-reproducible-example" class="external-link">How
to create a minimal, reproducible example</a></li>
</ul>
<p>Things we will need to know:</p>
<ul>
<li>The contents of <code><a href="../reference/hipercow_configuration.html">hipercow::hipercow_configuration()</a></code>
</li>
<li>What you’ve tried doing</li>
<li>The values of any errors (not just that they occurred!)</li>
<li>Logs of the offending task if you have it</li>
</ul>
<p>Too often, we will get requests for help with no information about
what was run, what packages or versions are being installed, etc. This
means your message sits there until we see it, we’ll ask for
clarification - that message sits there until you see it, you respond
with a little more information, and it may be days until we finally
discover the root cause of your problem, by which point we’re both quite
fed up. We will never complain if you provide “too much” information in
a good effort to outline where your problem is.</p>
<p><strong>Don’t say</strong></p>
<blockquote>
<p>Hi, I was running a cluster task, but it seems like it failed. I’m
sure it worked the other day though! Do you know what the problem
is?</p>
</blockquote>
<p><strong>Do say</strong></p>
<blockquote>
<p>Since yesterday, my cluster task has stopped working.</p>
<p>My DIDE username is <code>alicebobson</code> and my configuration
is:</p>
<pre><code>-- hipercow configuration -----
[etc]</code></pre>
<p>I have set up my cluster task with</p>
<pre><code><span><span class="co"># include short script here if you can!</span></span></code></pre>
<p>The task <code>43333cbd79ccbf9ede79556b592473c8</code> is one that
failed with an error, and the log says</p>
<pre><code><span><span class="co"># contents of task_log_show(id) here</span></span></code></pre>
</blockquote>
<p>with this sort of information the problem may just jump out at us, or
we may be able to create the error ourselves - either way we may be able
to work on the problem and get back to you with a solution rather than a
request for more information.</p>
<p>Other tips, and reasons you may have been directed to this page:</p>
<ul>
<li>
<strong>Please provide the whole error message</strong>. Do not
provide only the line of that you think is interesting. You can store a
great many lines of text in Teams, and you can always attach file if you
need to. We would really like to see as much information as
possible.</li>
<li>
<strong>Please do not provide screenshots</strong> or photos of text
unless for some reason your computer has lost the ability to copy and
paste.</li>
<li>
<strong>Please provide as much context as possible</strong> as to
what you are working on, and where. Please don’t assume that we remember
anything you told us in a previous discussion - we’ve probably forgotten
and you have more context about your problem at the point where you ask
than we do.</li>
<li>
<strong>Please let us know how you got in</strong>; if you have
asked us about a problem and have solved it, please let us know it is
working, anything extra you did to get it working, and anything we can
do to make the documentation clearer.</li>
<li>In general, please try and reduce the chance that our response to
your message has to be another question from us to you. It may feel like
you will get to your answer quicker if you don’t try and investigate at
your end, but it will take much longer overall and use up more of
everyone’s time.</li>
</ul>
<p>We do want to help, but expect slower responses where we have to do
lots of discovery to find out what your problem is, it will take longer
until we find the time and energy to start digging. The more information
you provide, the more likely it is we can spot the error.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn, Wes Hinsley, Paul Liétar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
