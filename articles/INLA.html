<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using INLA on Windows • hipercow</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Using INLA on Windows">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hipercow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/hipercow.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>General</h6></li>
    <li><a class="dropdown-item" href="../articles/packages.html">Packages and provisioning</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Tasks</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Details</h6></li>
    <li><a class="dropdown-item" href="../articles/details.html">Details</a></li>
    <li><a class="dropdown-item" href="../articles/environments.html">Environments</a></li>
    <li><a class="dropdown-item" href="../articles/stan.html">Using stan</a></li>
    <li><a class="dropdown-item" href="../articles/INLA.html">Using INLA on Windows</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Clusters</h6></li>
    <li><a class="dropdown-item" href="../articles/dide-cluster.html">The DIDE Cluster</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced topics</h6></li>
    <li><a class="dropdown-item" href="../articles/workers.html">Workers</a></li>
    <li><a class="dropdown-item" href="../articles/administration.html">Administration</a></li>
    <li><a class="dropdown-item" href="../articles/migration.html">Migration from didehpc</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/hipercow/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using INLA on Windows</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/hipercow/blob/main/vignettes/INLA.Rmd" class="external-link"><code>vignettes/INLA.Rmd</code></a></small>
      <div class="d-none name"><code>INLA.Rmd</code></div>
    </div>

    
    
<p><a href="https://www.r-inla.org" class="external-link">INLA</a> is an R package for
Bayesian inference for Latent Gaussian Models. There are a few
challenges in getting started:-</p>
<ul>
<li>It is not on CRAN, because the building process is
non-standard…</li>
<li>…because at present building from source on Windows does not
work,</li>
<li>INLA do provide working binaries, but no retro-building. When there
is a new INLA release, one binary is made for the current latest minor
version of R (4.4 at present). No binaries of new INLA for old R, or old
INLA for new R.</li>
<li>If you follow the install instructions on an older version of R such
as 4.3, R knows there is a newer INLA source version and tries to
install it from source. Which does not go well.</li>
</ul>
<p>For reference, the error you get attempting to install INLA from
source (whether you intended to install from source or not), looks
something like this, which I got for R 4.3 this morning:-</p>
<pre><code>&gt; install.packages("INLA",
    repos = c(getOption("repos"),
      INLA = "https://inla.r-inla-download.org/R/stable"), 
    dep = TRUE) 

There is a binary version available but the source version is later:
         binary   source needs_compilation
INLA 24.05.01-1 24.05.10             FALSE

installing the source package ‘INLA’

trying URL 'https://inla.r-inla-download.org/R/stable/src/contrib/INLA_24.05.10.tar.gz'
Content type 'application/x-gzip' length 61448956 bytes (58.6 MB)
downloaded 58.6 MB

* installing *binary* package 'INLA' ...
C:\WINDOWS\cp.exe: invalid option -- )
Try `C:\WINDOWS\cp.exe --help' for more information.
ERROR: installing binary package failed
* removing 'E:/Rlib/INLA'
Warning in install.packages :
  installation of package ‘INLA’ had non-zero exit status</code></pre>
<p>The latest binary release turns out to be <code>24.05.01-1</code> -
but it knows there is a more recent source available and tries to build
it. The easiest fix is to force <code>type = "binary"</code> in
<code>install.packages</code>, and settle for the
<code>24.05.01-1</code> binary.</p>
<p>See <a href="https://github.com/hrue/r-inla/issues/99" class="external-link">this issue</a>
for the discussion, leading to the options below. Begin by asking
yourself three questions:-</p>
<ol style="list-style-type: decimal">
<li>Do I want to install locally, or provision with Hipercow</li>
<li>Do I want to use the latest version of INLA, or an older one.</li>
<li>And you do know what your R version is? Should you upgrade?</li>
</ol>
<div class="section level2">
<h2 id="local-installations">Local installations<a class="anchor" aria-label="anchor" href="#local-installations"></a>
</h2>
<div class="section level3">
<h3 id="latest-available-version-of-inla-for-your-r-version">Latest available version of INLA for your R version<a class="anchor" aria-label="anchor" href="#latest-available-version-of-inla-for-your-r-version"></a>
</h3>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"INLA"</span>, </span>
<span>  repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span>, </span>
<span>          INLA <span class="op">=</span> <span class="st">"https://inla.r-inla-download.org/R/stable"</span><span class="op">)</span>, </span>
<span>      dep <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span></code></pre>
<p>This works. Right now, if you do this from within R 4.4, you will get
version <code>24.05.10</code>, whereas for R 4.3, you will get
<code>24.05.01-1</code>. The exact version you get will be the most
recent version you find in <a href="https://inla.r-inla-download.org/R/stable/bin/windows/contrib/4.4/" class="external-link">here
for R 4.4</a> or <a href="https://inla.r-inla-download.org/R/stable/bin/windows/contrib/4.3/" class="external-link">here
for R 4.3</a>, or other folders for even older R.</p>
<p>If you are not on the latest version of R, you likely will not be
able to get the latest version of INLA, because the INLA team only make
new releases for the latest R version. Therefore, if you really need the
latest INLA, you must be on the latest version of R.</p>
</div>
<div class="section level3">
<h3 id="specific-version-of-inla-where-available-">Specific version of INLA, where available.<a class="anchor" aria-label="anchor" href="#specific-version-of-inla-where-available-"></a>
</h3>
<p>So <code>install.packages</code> does not allow us to choose a
version, and <code>remotes::install_version</code> only works when
<code>type="source"</code>, which you may recall me mentioning once or
twice, cannot succeed for <em>reasons</em>.</p>
<p>If you want a specific version of INLA, you are limited to the
binaries the INLA team have made for your R version. So look in <a href="https://inla.r-inla-download.org/R/stable/bin/windows/contrib/4.4/" class="external-link">here
for R 4.4</a> or <a href="https://inla.r-inla-download.org/R/stable/bin/windows/contrib/4.3/" class="external-link">here
for R 4.3</a> for example, and find your desired version. For R 4.3,
<code>INLA_23.09.09.zip</code> looks nice.</p>
<p>Download the zip, and use
<code>R CMD INSTALL INLA_23.09.09.zip</code> - or to do this all in R,
you could try:-</p>
<pre><code><span><span class="va">tmpdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">version</span> <span class="op">&lt;-</span> <span class="st">"23.09.09"</span></span>
<span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"INLA_%s.zip"</span>, <span class="va">version</span><span class="op">)</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"https://inla.r-inla-download.org/R/stable/bin/windows/contrib/4.3/%s"</span>, <span class="va">file</span><span class="op">)</span></span>
<span><span class="va">tmpfile</span> <span class="op">&lt;-</span> <span class="fu">path.file</span><span class="op">(</span><span class="va">tmpdir</span>, <span class="va">file</span><span class="op">)</span></span>
<span><span class="fu">curl</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/curl/reference/curl_download.html" class="external-link">curl_download</a></span><span class="op">(</span><span class="va">url</span>, <span class="va">tmpfile</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">tmpfile</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">tmpfile</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="hipercow-provisioning">Hipercow provisioning<a class="anchor" aria-label="anchor" href="#hipercow-provisioning"></a>
</h2>
<div class="section level3">
<h3 id="latest-version-of-inla-for-latest-r-version-">Latest version of INLA for latest R version.<a class="anchor" aria-label="anchor" href="#latest-version-of-inla-for-latest-r-version-"></a>
</h3>
<p>The current latest R version is 4.4. If you are using that version,
then you can either use the <code>script</code> or the
<code>pkgdepends</code> method.</p>
<p>For <code>pkgdepends</code>, in your <code>hipercow</code> root you
can write in <code>pkgdepends.txt</code> :-</p>
<pre><code>repo::https://inla.r-inla-download.org/R/stable
INLA</code></pre>
<p>For the <code>script</code> method, you instead write
<code>provision.R</code> and paste this code to install the package,
which is the same as the local install:-</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"INLA"</span>, </span>
<span>  repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span>, </span>
<span>          INLA <span class="op">=</span> <span class="st">"https://inla.r-inla-download.org/R/stable"</span><span class="op">)</span>, </span>
<span>      dep <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span></code></pre>
<p>Then <code><a href="../reference/hipercow_provision.html">hipercow_provision()</a></code> will work in the usual way.
See <code><a href="../articles/packages.html">vignette("packages")</a></code> for more details.</p>
</div>
<div class="section level3">
<h3 id="latest-version-of-inla-for-older-r-version">Latest version of INLA for older R version<a class="anchor" aria-label="anchor" href="#latest-version-of-inla-for-older-r-version"></a>
</h3>
<p>Here, the <code>script</code> method above will work as before, but
if you prefer <code>pkgdepends</code>, you will have to be
<strong>specific</strong> about the version you want to install, and it
<strong>must</strong> be the most recent version for your R version. So
for R 4.3, your <code>pkgdepends.txt</code> would have to say:-</p>
<pre><code>repo::https://inla.r-inla-download.org/R/stable
INLA@24.05.01-01</code></pre>
<p>because that is the latest version we see <a href="https://inla.r-inla-download.org/R/stable/bin/windows/contrib/4.3/" class="external-link">here</a>.</p>
</div>
<div class="section level3">
<h3 id="specific-version-of-inla-where-available--1">Specific version of INLA, where available.<a class="anchor" aria-label="anchor" href="#specific-version-of-inla-where-available--1"></a>
</h3>
<p>See the instructions above for a local installation, put the code in
<code>provision.R</code> to use the <code>script</code> method with
<code><a href="../reference/hipercow_provision.html">hipercow_provision()</a></code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn, Wes Hinsley, Paul Liétar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
