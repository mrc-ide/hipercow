<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Migration from didehpc • hipercow</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Migration from didehpc">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hipercow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/hipercow.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>General</h6></li>
    <li><a class="dropdown-item" href="../articles/packages.html">Packages and provisioning</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Tasks</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Details</h6></li>
    <li><a class="dropdown-item" href="../articles/details.html">Details</a></li>
    <li><a class="dropdown-item" href="../articles/environments.html">Environments</a></li>
    <li><a class="dropdown-item" href="../articles/secrets.html">Using secrets on the cluster</a></li>
    <li><a class="dropdown-item" href="../articles/stan.html">Using stan</a></li>
    <li><a class="dropdown-item" href="../articles/INLA.html">Using INLA on Windows</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Clusters</h6></li>
    <li><a class="dropdown-item" href="../articles/dide-cluster.html">The DIDE Cluster</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced topics</h6></li>
    <li><a class="dropdown-item" href="../articles/workers.html">Workers</a></li>
    <li><a class="dropdown-item" href="../articles/administration.html">Administration</a></li>
    <li><a class="dropdown-item" href="../articles/migration.html">Migration from didehpc</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/hipercow/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Migration from didehpc</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/hipercow/blob/main/vignettes/migration.Rmd" class="external-link"><code>vignettes/migration.Rmd</code></a></small>
      <div class="d-none name"><code>migration.Rmd</code></div>
    </div>

    
    
<p>The <code>hipercow</code> package shares many of its ideas from <a href="https://mrc-ide.github.io/didehpc/" class="external-link"><code>didehpc</code></a> but
is a new implementation, sharing little code and offering no direct
migration path. If you have an existing <code>didehpc</code>-based
project, you should keep using that and use <code>hipercow</code> for
any new work.</p>
<p>If you have never used <code>didehpc</code> before, there is no need
to read this vignette.</p>
<div class="section level2">
<h2 id="differences">Differences<a class="anchor" aria-label="anchor" href="#differences"></a>
</h2>
<p>Some differences of note between <code>hipercow</code> and
<code>didehpc</code>; if you are confused by some other difference not
mentioned here please let us know.</p>
<p><strong>The user interface is quite different, with free functions
replacing the big <code>queue_didehpc</code> object</strong>. Previously
you created an object (often <code>obj</code>) with <a href="https://mrc-ide.github.io/didehpc/reference/queue_didehpc.html" class="external-link"><code>queue_didehpc</code></a>
and then interacted with this by running a method (say
<code>obj$task_result()</code>); instead in <code>hipercow</code> you
use a free function (in this example <code>task_result</code>). See
below for a translation of methods to new function(s).</p>
<p><strong>No object corresponding to a task</strong>. Previously there
were object handles that had methods. So you had a task <code>t</code>
and fetched its result as <code>t$result()</code>. As with the queue,
this has moved to free functions (in this example
<code><a href="../reference/task_result.html">task_result()</a></code>).</p>
<p><strong>We no longer check that your packages have been
installed</strong>. We might modify this behaviour, but the previous
behaviour of not allowing the queue object to be created until packages
have been installed has been stopped. Instead, we provide some tools
(notably, <code><a href="../reference/hipercow_provision_list.html">hipercow_provision_check()</a></code>) for you to check that
the state of the packages is what you expect them to be. There’s nothing
to stop you submitting tasks into a cluster environment that cannot run
them due to missing packages, but we hope that will be more
flexible.</p>
<p><strong>We never load packages into your current environment, you
don’t even need them installed</strong>. In didehpc when you loaded the
queue, it loaded all packages in your context in your current session.
This no longer happens, and the packages do not need to be installed at
all.</p>
<p>Smaller differences include:</p>
<ul>
<li>
<code>task_wait</code> does not return the result of the task, but a
boolean indicating if the task was successful</li>
</ul>
<div class="section level3">
<h3 id="mapping-of-didehpc-methods-to-hipercow-functions">Mapping of <code>didehpc</code> methods to <code>hipercow</code>
functions<a class="anchor" aria-label="anchor" href="#mapping-of-didehpc-methods-to-hipercow-functions"></a>
</h3>
<div class="section level4">
<h4 id="queue_didehpc">
<code>queue_didehpc</code><a class="anchor" aria-label="anchor" href="#queue_didehpc"></a>
</h4>
<ul>
<li>
<code>cluster_load</code>: TODO (<code>mrc-4892</code>)</li>
<li>
<code>config</code>: <code><a href="../reference/hipercow_configuration.html">hipercow_configuration()</a></code>
</li>
<li>
<code>context</code>: no analogue</li>
<li>
<code>dide_id</code>: no analogue (we might add this to
<code><a href="../reference/task_info.html">task_info()</a></code> though)</li>
<li>
<code>dide_log</code>: <code><a href="../reference/task_log.html">task_log_show()</a></code> with argument
<code>outer = TRUE</code>
</li>
<li>
<code>enqueue</code>: <code><a href="../reference/task_create_expr.html">task_create_expr()</a></code>
</li>
<li>
<code>enqueue_</code>: <code><a href="../reference/task_create_explicit.html">task_create_explicit()</a></code>
</li>
<li>
<code>enqueue_bulk</code>: <code><a href="../reference/task_create_bulk_expr.html">task_create_bulk_expr()</a></code>
</li>
<li>
<code>initialize_context</code>: no analogue</li>
<li>
<code>install_packages</code>: <code><a href="../reference/hipercow_provision.html">hipercow_provision()</a></code>
with arguments <code>method = "pkgdepends", refs = ...</code>
</li>
<li>
<code>lapply</code>: <code><a href="../reference/task_create_bulk_call.html">task_create_bulk_call()</a></code>
</li>
<li>
<code>login</code>: <code><a href="../reference/dide_check.html">dide_check()</a></code> (we don’t actually log
in this way though)</li>
<li>
<code>mapply</code>: <code><a href="../reference/task_create_bulk_call.html">task_create_bulk_call()</a></code>
</li>
<li>
<code>provision_context</code>:
<code><a href="../reference/hipercow_provision.html">hipercow_provision()</a></code>
</li>
<li>
<code>reconcile</code>: <code><a href="../reference/task_info.html">task_info()</a></code> (but only one id at
a time, and only reconciles as a side effect)</li>
<li>
<code>rrq_controller</code>:</li>
<li>
<code>stop_workers</code>: TODO (<code>mrc-4869</code>)</li>
<li>
<code>submit</code>: <code><a href="../reference/task_submit.html">task_submit()</a></code>
</li>
<li>
<code>submit_workers</code>: TODO (<code>mrc-4869</code>)</li>
<li>
<code>task_bundle_get</code>:
<code><a href="../reference/hipercow_bundle_load.html">hipercow_bundle_load()</a></code>
</li>
<li>
<code>task_bundle_info</code>: no analogue, as bundles no longer
need to share anything common.</li>
<li>
<code>task_bundle_list</code>:
<code><a href="../reference/hipercow_bundle_list.html">hipercow_bundle_list()</a></code>
</li>
<li>
<code>task_delete</code>: TODO (<code>mrc-4842</code>)</li>
<li>
<code>task_get</code>: no analogue (see below)</li>
<li>
<code>task_list</code>: not implemented. Practically this was quite
slow for real-world usage and not terribly useful, so we might just skip
doing it. Let us know if this bothers you.</li>
<li>
<code>task_result</code>: <code><a href="../reference/task_result.html">task_result()</a></code> (but only for a
single task)</li>
<li>
<code>task_status</code>: <code><a href="../reference/task_status.html">task_status()</a></code>
</li>
<li>
<code>task_times</code>: <code><a href="../reference/task_info.html">task_info()</a></code>
</li>
<li>
<code>unsubmit</code>: <code><a href="../reference/task_cancel.html">task_cancel()</a></code>
</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="task">
<code>task</code><a class="anchor" aria-label="anchor" href="#task"></a>
</h3>
<p>Running <code>task_get</code>, or creating a task with
<code>$enqueue()</code> returned a task object. The methods on this
correspond again to free functions in <code>hipercow</code>:</p>
<ul>
<li>
<code>context_id</code>: no analogue</li>
<li>
<code>expr</code>: <code><a href="../reference/task_info.html">task_info()</a></code>
</li>
<li>
<code>log</code>: <code><a href="../reference/task_log.html">task_log_show()</a></code> and
<code><a href="../reference/task_log.html">task_log_value()</a></code>, also <code><a href="../reference/task_log.html">task_log_watch()</a></code>
</li>
<li>
<code>result</code>: <code><a href="../reference/task_result.html">task_result()</a></code>
</li>
<li>
<code>status</code>: <code><a href="../reference/task_status.html">task_status()</a></code>
</li>
<li>
<code>times</code>: <code><a href="../reference/task_info.html">task_info()</a></code>
</li>
<li>
<code>wait</code>: <code><a href="../reference/task_wait.html">task_wait()</a></code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="bundle">
<code>bundle</code><a class="anchor" aria-label="anchor" href="#bundle"></a>
</h3>
<p>Running <code>$task_bundle_get()</code> or creating a bulk submission
with <code>$enqueue_bulk()</code> or <code>$lapply()</code> created a
task bundle object. The methods on this correspond to free functions in
<code>hipercow</code>:</p>
<ul>
<li>
<code>times</code>: not yet implemented (will be
<code>hipercow_bundle_info</code>)</li>
<li>
<code>results</code>: <code><a href="../reference/hipercow_bundle_result.html">hipercow_bundle_result()</a></code>
</li>
<li>
<code>wait</code>: <code><a href="../reference/hipercow_bundle_wait.html">hipercow_bundle_wait()</a></code>
</li>
<li>
<code>status</code>: <code><a href="../reference/hipercow_bundle_status.html">hipercow_bundle_status()</a></code>
</li>
<li>
<code>expr</code>: not yet implemented, may go into
<code>hipercow_bundle_info</code>
</li>
<li>
<code>function_name</code>: not implemented</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="configuration">Configuration<a class="anchor" aria-label="anchor" href="#configuration"></a>
</h2>
<p>Previously you might have used <code>didehpc_config</code> to change
lots of bits of didehpc’s behaviour. We’ve removed most of this for now!
Below is a list of arguments to <a href="https://mrc-ide.github.io/didehpc/reference/didehpc_config.html" class="external-link"><code>didehpc_config()</code></a>
and</p>
<ul>
<li>
<code>credentials</code>: the first time you use
<code>hipercow</code> you should use <code>dide_authenticate</code> to
arrange your credentials and securely save them in your keychain.</li>
<li>
<code>home</code>: this used to be information about where to mount
your home drive, which we always did. We no longer mount it by default
unless it is your working directory.</li>
<li>
<code>temp</code>: this used to be information about the temp drive,
we do not mount this by default either.</li>
<li>
<code>cluster</code>: this was the cluster to use. That’s not
currently configurable as we only support one (<code>wpia-hn</code>, the
“new cluster”). This may reappear as a Windows-specific option to
<code><a href="../reference/hipercow_configure.html">hipercow_configure()</a></code> later depending on how the cluster
setup goes.</li>
<li>
<code>shares</code>: this is still supported, as the
<code>shares</code> option to <code><a href="../reference/hipercow_configure.html">hipercow_configure()</a></code>
</li>
<li>
<code>template</code>: this is renamed to <code>queue</code> in
<code><a href="../reference/hipercow_resources.html">hipercow_resources()</a></code>, which is what <code>template</code>
essentially meant. You then pass your <code>hipercow_resources</code>
list to functions when creating tasks.</li>
<li>
<code>cores</code>: this is the <code>cores</code> option in
<code><a href="../reference/hipercow_resources.html">hipercow_resources()</a></code>.</li>
<li>
<code>nodes</code>: this wasn’t really useful in
<code>didehpc</code>, since it reserved nodes but could only use one of
them. For now, it is not implemented in <code>hipercow</code>.</li>
<li>
<code>wholenode</code>: this is more flexible now. Setting
<code>cores</code> to <code>Inf</code> will request a whole node,
however many cores it has. Setting <code>exclusive</code> to
<code>TRUE</code> ensures that no other task runs on the node at the
same time as yours, even if you request a smaller number of cores than
the node has.</li>
<li>
<code>parallel</code>: call <code><a href="../reference/hipercow_parallel.html">hipercow_parallel()</a></code> with
the argument <code>"future"</code> or <code>"parallel</code>” and pass
the result to the <code>parallel</code> argument when creating your
task, to set up a local cluster within a node. Parallel processing can
additionally be done by requesting multiple cores with
<code><a href="../reference/hipercow_resources.html">hipercow_resources()</a></code>, which sets useful environment
variables for some thread-capable packages that use them.</li>
<li>
<code>workdir</code>: no longer specified; the path to your working
directory is determined automatically.</li>
<li>
<code>use_workers</code>: workers are not yet supported, and the
interface will change</li>
<li>
<code>use_rrq</code>: <code>rrq</code> is not yet supported, and the
interface will change</li>
<li>
<code>worker_timeout</code>: workers are not yet supported, and the
interface will change</li>
<li>
<code>worker_resource</code>: workers are not yet supported, and the
interface will change</li>
<li>
<code>conan_bootstrap</code>: no longer configurable, this should
just work for you now.</li>
<li>
<code>r_version</code>: this is still supported, as the
<code>r_version</code> option to <code><a href="../reference/hipercow_configure.html">hipercow_configure()</a></code>
</li>
<li>
<code>use_java</code>: This is no longer needed; A recent Java LTS
is always available for <code>rJava</code> and packages that use
it.</li>
<li>
<code>java_home</code>: This is no longer needed; the JAVA_HOME
environment variable is automatically set to a recent Java LTS
release.</li>
</ul>
</div>
<div class="section level2">
<h2 id="missing-features">Missing features<a class="anchor" aria-label="anchor" href="#missing-features"></a>
</h2>
<p>Features that we are planning to implement, but that are not yet
available. If you use these you should not yet migrate to
<code>hipercow</code>. Let us know in the Cluster channel if these are
blocking you moving and it’s helpful for us to prioritise.</p>
<ul>
<li>Use of workers, or with <a href="https://mrc-ide.github.io/rrq" class="external-link"><code>rrq</code></a> in
general</li>
<li>Dependencies between tasks (e.g., submit a task after another has
completed); we’ll implement this but nobody was actually using it to our
knowledge.</li>
</ul>
</div>
<div class="section level2">
<h2 id="new-features">New features<a class="anchor" aria-label="anchor" href="#new-features"></a>
</h2>
<ul>
<li>Support for provisioning environments with <code>renv</code>
</li>
<li>Support for an escape hatch method of provisioning with scripts; use
whatever you want</li>
<li>Most users should very rarely need to enter a password</li>
<li>Most configuration now automatic</li>
<li>Simple method to retry failed (or otherwise unsatisfactory)
tasks</li>
<li>Resources offer specifying a maximum runtime, memory requirements,
indicating when tasks should run, lowering priority, and better parallel
support.</li>
<li>Easily stream logs out from a running task</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn, Wes Hinsley, Paul Liétar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
